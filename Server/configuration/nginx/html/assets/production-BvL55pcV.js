import{j as o,B as E,T as W,g as N,h as $,r as a,i as A,q as ce,Q as Z,R as de,_ as F,k as x,U as pe,s as y,l as w,V as k,n as _,W as ue,X as xe,Y as ge,u as ee,f as Y,y as O,S as R,a as te,P as he,M as fe,b as V,m as q,w as me,I as be,x as Ce,D as ve,z as je,H as ye}from"./index-CFNC7h2J.js";import{C as De}from"./config-global-DGEDRhMa.js";import{S as U,C as Pe}from"./Card-Bbletgcf.js";import{T as L,a as h,R as G,b as we,c as Se,d as Te,e as ke,f as Re,g as We}from"./TableSortLabel-ClTJlm8w.js";import{P as Me,O as Be,b as Ne}from"./main-B170k_Ud.js";import{L as $e}from"./loading_page-DFUGQDgK.js";function Ae({searchQuery:e,...t}){return o.jsx(L,{...t,children:o.jsx(h,{align:"center",colSpan:7,children:o.jsxs(E,{sx:{py:15,textAlign:"center"},children:[o.jsx(W,{variant:"h6",sx:{mb:1},children:"Not found"}),o.jsxs(W,{variant:"body2",children:["No results found for  ",o.jsxs("strong",{children:['"',e,'"']}),".",o.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function Fe(e){return $("MuiDialog",e)}const K=N("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),oe=a.createContext({}),_e=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],Ie=y(xe,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Oe=e=>{const{classes:t,scroll:s,maxWidth:i,fullWidth:l,fullScreen:r}=e,n={root:["root"],container:["container",`scroll${k(s)}`],paper:["paper",`paperScroll${k(s)}`,`paperWidth${k(String(i))}`,l&&"paperFullWidth",r&&"paperFullScreen"]};return _(n,Fe,t)},Ue=y(ue,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Ee=y("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.container,t[`scroll${k(s.scroll)}`]]}})(({ownerState:e})=>x({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Le=y(Z,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.paper,t[`scrollPaper${k(s.scroll)}`],t[`paperWidth${k(String(s.maxWidth))}`],s.fullWidth&&t.paperFullWidth,s.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>x({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},t.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},t.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},t.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${K.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&t.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${K.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${K.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),ze=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialog"}),l=ce(),r={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":n,"aria-labelledby":d,BackdropComponent:p,BackdropProps:b,children:C,className:D,disableEscapeKeyDown:v=!1,fullScreen:f=!1,fullWidth:P=!1,maxWidth:g="sm",onBackdropClick:c,onClick:m,onClose:j,open:u,PaperComponent:M=Z,PaperProps:B={},scroll:S="paper",TransitionComponent:se=de,transitionDuration:Q=r,TransitionProps:ne}=i,ie=F(i,_e),I=x({},i,{disableEscapeKeyDown:v,fullScreen:f,fullWidth:P,maxWidth:g,scroll:S}),z=Oe(I),X=a.useRef(),ae=T=>{X.current=T.target===T.currentTarget},re=T=>{m&&m(T),X.current&&(X.current=null,c&&c(T),j&&j(T,"backdropClick"))},H=pe(d),le=a.useMemo(()=>({titleId:H}),[H]);return o.jsx(Ue,x({className:w(z.root,D),closeAfterTransition:!0,components:{Backdrop:Ie},componentsProps:{backdrop:x({transitionDuration:Q,as:p},b)},disableEscapeKeyDown:v,onClose:j,open:u,ref:s,onClick:re,ownerState:I},ie,{children:o.jsx(se,x({appear:!0,in:u,timeout:Q,role:"presentation"},ne,{children:o.jsx(Ee,{className:w(z.container),onMouseDown:ae,ownerState:I,children:o.jsx(Le,x({as:M,elevation:24,role:"dialog","aria-describedby":n,"aria-labelledby":H},B,{className:w(z.paper,B.className),ownerState:I,children:o.jsx(oe.Provider,{value:le,children:C})}))})}))}))});function Xe(e){return $("MuiDialogActions",e)}N("MuiDialogActions",["root","spacing"]);const He=["className","disableSpacing"],Ye=e=>{const{classes:t,disableSpacing:s}=e;return _({root:["root",!s&&"spacing"]},Xe,t)},Ge=y("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>x({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Ke=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogActions"}),{className:l,disableSpacing:r=!1}=i,n=F(i,He),d=x({},i,{disableSpacing:r}),p=Ye(d);return o.jsx(Ge,x({className:w(p.root,l),ownerState:d,ref:s},n))});function Qe(e){return $("MuiDialogContent",e)}N("MuiDialogContent",["root","dividers"]);function Ve(e){return $("MuiDialogTitle",e)}const qe=N("MuiDialogTitle",["root"]),Je=["className","dividers"],Ze=e=>{const{classes:t,dividers:s}=e;return _({root:["root",s&&"dividers"]},Qe,t)},et=y("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>x({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${qe.root} + &`]:{paddingTop:0}})),tt=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogContent"}),{className:l,dividers:r=!1}=i,n=F(i,Je),d=x({},i,{dividers:r}),p=Ze(d);return o.jsx(et,x({className:w(p.root,l),ownerState:d,ref:s},n))});function ot(e){return $("MuiDialogContentText",e)}N("MuiDialogContentText",["root"]);const st=["children","className"],nt=e=>{const{classes:t}=e,i=_({root:["root"]},ot,t);return x({},t,i)},it=y(W,{shouldForwardProp:e=>ge(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),at=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogContentText"}),{className:l}=i,r=F(i,st),n=nt(r);return o.jsx(it,x({component:"p",variant:"body1",color:"text.secondary",ref:s,ownerState:r,className:w(n.root,l)},i,{classes:n}))}),rt=["className","id"],lt=e=>{const{classes:t}=e;return _({root:["root"]},Ve,t)},ct=y(W,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),dt=a.forwardRef(function(t,s){const i=A({props:t,name:"MuiDialogTitle"}),{className:l,id:r}=i,n=F(i,rt),d=i,p=lt(d),{titleId:b=r}=a.useContext(oe);return o.jsx(ct,x({component:"h2",className:w(p.root,l),ownerState:d,ref:s,variant:"h6",id:r??b},n))});function pt({row:e,selected:t,eventsRows:s,onEventsRows:i,onSelectRow:l}){const r=ee(),[n,d]=a.useState(null),[p,b]=a.useState("paper"),[C,D]=a.useState(!1),v=a.useCallback(u=>{d(u.currentTarget)},[]),f=a.useCallback(()=>{d(null)},[]),P=u=>()=>{D(!0),b(u)},g=()=>{D(!1)},c=u=>()=>{const{machine:M,start_product:B,finish_product:S}=u;M&&B&&S&&r("/Details",{state:u})},m=u=>{U.fire({title:"ยืนยันการลบรายการ",text:`ชื่อยา: ${u.product_name} เลขที่ผลิต: ${u.lot_number}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"ยืนยันการลบ !",cancelButtonText:"ยกเลิก"}).then(M=>{M.isConfirmed&&(async()=>{try{const S=await Me(u);i(!s),U.fire({icon:"success",title:"ดำเนินการเรียบร้อยแล้ว",text:"บันทึกรายการผลิตเรียบร้อยแล้ว",showConfirmButton:!1,timer:2e3})}catch(S){console.error("Error fetching data:",S),U.fire({icon:"error",title:"เกิดข้อผิดพลาด...",text:"ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้!, ลองไหม่อีกครั้ง",showCancelButton:!0,cancelButtonText:"ปิด"})}})()})},j=a.useRef(null);return a.useEffect(()=>{if(C){const{current:u}=j;u!==null&&u.focus()}},[C]),o.jsxs(o.Fragment,{children:[o.jsxs(L,{hover:!0,selected:t,style:{verticalAlign:"middle"},children:[o.jsx(h,{component:"th",scope:"row",children:o.jsxs(E,{gap:1,display:"flex",alignItems:"center",children:[o.jsx(G,{src:"/assets/icons/iconify/overtime.svg",style:{width:"40px",height:"40px"}}),Y(e.timestamp)]})}),o.jsx(h,{children:e.lot_number}),o.jsx(h,{children:e.product_name}),o.jsx(h,{children:e.batch_size?e.batch_size.toLocaleString():"X,XXX"}),o.jsx(h,{children:e.machine}),o.jsx(h,{children:Y(e.start_product)}),o.jsx(h,{children:Y(e.finish_product)}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:P("paper"),children:o.jsx(G,{src:"/assets/icons/iconify/note.svg",style:{width:"30px",height:"30px"}})})}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:c(e),children:o.jsx(G,{src:"/assets/icons/iconify/info.svg",style:{width:"30px",height:"30px"}})})}),o.jsx(h,{align:"center",children:o.jsx(O,{onClick:v,children:o.jsx(R,{src:"/assets/icons/iconify/menu.svg",width:"25px",height:"25px"})})})]}),o.jsxs(ze,{fullWidth:!0,maxWidth:"sm",open:C,onClose:g,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[o.jsx(dt,{id:"scroll-dialog-title",children:"รายละเอียดเพิ่มเติม"}),o.jsx(tt,{dividers:p==="paper",children:o.jsx(at,{id:"scroll-dialog-description",ref:j,tabIndex:-1,children:e.notes})}),o.jsx(Ke,{children:o.jsx(te,{onClick:g,variant:"contained",color:"error",children:"ปิด"})})]}),o.jsx(he,{open:!!n,anchorEl:n,onClose:f,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:o.jsxs(fe,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${q.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${q.selected}`]:{bgcolor:"action.selected"}}},children:[o.jsxs(V,{onClick:()=>{f(),e&&r("/production/form",{state:{row:e}})},children:[o.jsx(R,{src:"/assets/icons/iconify/edit.svg",width:"20px",height:"20px"}),"แก้ไข"]}),o.jsxs(V,{onClick:()=>{f(),m(e)},sx:{color:"error.main"},children:[o.jsx(R,{src:"/assets/icons/iconify/delete.svg",width:"20px",height:"20px"}),"ลบ"]})]})})]})}const ut={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function xt(e,t,s){return e?Math.max(0,(1+e)*t-s):0}function J(e,t,s){return t[s]<e[s]?-1:t[s]>e[s]?1:0}function gt(e,t){return e==="desc"?(s,i)=>-J(s,i,t):(s,i)=>J(s,i,t)}function ht({inputData:e,comparator:t,filterName:s,order:i}){const l=e.map((r,n)=>[r,n]);return l.sort((r,n)=>{const d=t(r[0],n[0]);return d!==0?d:r[1]-n[1]}),e=l.map(r=>r[0]),s&&(e=e.filter(r=>Object.values(r).some(n=>String(n).toLowerCase().includes(s.toLowerCase())))),e}function ft({order:e,onSort:t,orderBy:s,rowCount:i,headLabel:l,numSelected:r}){return o.jsx(we,{children:o.jsx(L,{style:{verticalAlign:"top"},children:l.map(n=>o.jsx(h,{align:n.align||"left",sortDirection:s===n.id?e:!1,sx:{width:n.width,minWidth:n.minWidth},children:o.jsxs(Se,{hideSortIcon:!0,active:s===n.id,direction:s===n.id?e:"asc",onClick:()=>t(n.id),children:[n.label,s===n.id?o.jsx(E,{sx:{...ut},children:e==="desc"?"sorted descending":"sorted ascending"}):null]})},n.id))})})}function mt({emptyRows:e,height:t,sx:s,...i}){return e?o.jsx(L,{sx:{...t&&{height:t*e},...s},...i,children:o.jsx(h,{colSpan:9})}):null}function bt({numSelected:e,filterName:t,onFilterName:s}){return o.jsxs(me,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3),...e>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[e>0?o.jsxs(W,{component:"div",variant:"subtitle1",children:[e," selected"]}):o.jsx(Be,{fullWidth:!0,value:t,onChange:s,placeholder:"ค้นหาข้อมูลในตาราง...",startAdornment:o.jsx(be,{position:"start",children:o.jsx(R,{src:"/assets/icons/iconify/filter.svg",width:"20px",height:"20px",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),o.jsx(Ce,{title:"Filter list",children:o.jsx(O,{children:o.jsx(R,{src:"/assets/icons/iconify/filter.svg",width:"20px",height:"20px",sx:{color:"text.disabled"}})})})]})}function Ct(){const e=ee(),t=vt(),[s,i]=a.useState(!0),[l,r]=a.useState(!1),[n,d]=a.useState([]),[p,b]=a.useState(""),[C,D]=a.useState("");a.useEffect(()=>{(async()=>{try{const c=await Ne();i(!1),d(c),console.log(c)}catch(c){c.status===401||c.status===403?e("/sign-in"):(U.fire({icon:"error",title:"เกิดข้อผิดพลาด...",text:"ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้!",showConfirmButton:!1}),console.error("Error fetching data:",c))}})()},[l,e]);const v=()=>()=>{e("/production/form")},f=ht({inputData:n,comparator:gt(t.order,t.orderBy),filterName:p,order:"asc"}),P=!f.length&&!!p;return o.jsxs(o.Fragment,{children:[o.jsx($e,{isShowing:s}),o.jsxs(ve,{children:[o.jsxs(E,{display:"flex",alignItems:"center",mb:5,children:[o.jsx(W,{variant:"h4",flexGrow:1,children:"รายการผลิต"}),o.jsx(te,{variant:"contained",color:"inherit",onClick:v(),startIcon:o.jsx(R,{src:"/assets/icons/iconify/add.svg",width:"20px",height:"20px"}),children:"เพิ่มรายการ"})]}),o.jsxs(Pe,{children:[o.jsx(bt,{numSelected:t.selected.length,filterName:p,onFilterName:g=>{b(g.target.value),t.onResetPage()}}),o.jsx(je,{children:o.jsx(Te,{sx:{overflow:"unset"},children:o.jsxs(ke,{sx:{minWidth:1100},children:[o.jsx(ft,{order:t.order,orderBy:t.orderBy,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,headLabel:[{id:"timestamp",label:"Timestamp"},{id:"lot_number",label:"เลขที่ผลิต"},{id:"product_names",label:"รายการผลิต"},{id:"batch_size",label:"ขนาดผลิต"},{id:"machine",label:"เครื่องจักร"},{id:"start_product",label:"วันที่เริ่มการผลิต"},{id:"finish_product",label:"วันที่จบการผลิต"},{id:"note",label:"Note",align:"center"},{id:"info",label:"ข้อมูล",align:"center"},{id:"edit",label:"แก้ไข",align:"center"}]}),o.jsxs(Re,{children:[f.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(g=>o.jsx(pt,{row:g,eventsRows:l,onEventsRows:r,selected:t.selected.includes(g.id),onSelectRow:()=>t.onSelectRow(g.id)},g.id)),o.jsx(mt,{height:68,emptyRows:xt(t.page,t.rowsPerPage,n.length)}),P&&o.jsx(Ae,{searchQuery:p})]})]})})}),o.jsx(We,{component:"div",page:t.page,count:n.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:t.onChangeRowsPerPage})]})]})]})}function vt(){const[e,t]=a.useState(0),[s,i]=a.useState("name"),[l,r]=a.useState(5),[n,d]=a.useState([]),[p,b]=a.useState("asc"),C=a.useCallback(c=>{b(s===c&&p==="asc"?"desc":"asc"),i(c)},[p,s]),D=a.useCallback((c,m)=>{if(c){d(m);return}d([])},[]),v=a.useCallback(c=>{const m=n.includes(c)?n.filter(j=>j!==c):[...n,c];d(m)},[n]),f=a.useCallback(()=>{t(0)},[]),P=a.useCallback((c,m)=>{t(m)},[]),g=a.useCallback(c=>{r(parseInt(c.target.value,10)),f()},[f]);return{page:e,order:p,onSort:C,orderBy:s,selected:n,rowsPerPage:l,onSelectRow:v,onResetPage:f,onChangePage:P,onSelectAllRows:D,onChangeRowsPerPage:g}}function Tt(){return o.jsxs(o.Fragment,{children:[o.jsx(ye,{children:o.jsxs("title",{children:[" ",`Production - ${De.appName}`]})}),o.jsx(Ct,{})]})}export{Tt as default};
