import{h as C,j as e,T as k,B as b,a as F,n as I,u as L,s as T,q as v,r as g,H as M}from"./index-Dffueucq.js";import{C as G}from"./config-global-DQeLXOlG.js";import{C as E,S as A}from"./Card-D04T2_xm.js";import{u as S,C as O,a as B}from"./chart-legends-CZXyTZwA.js";import{E as R,W as K}from"./main-BLXQ8eMX.js";import{R as N}from"./react-svg.esm-Dqppu0-P.js";import{C as V}from"./CardContent-BDobIhmB.js";import{T as q,a as H}from"./Tabs-E9Y944ab.js";import{G as d}from"./Grid-r_4QW8b_.js";import"./Stack-DTSJCpmQ.js";import"./KeyboardArrowRight-BcpafqSf.js";function _({title:p,subheader:m,height:c,type:i,unit:l,chart:r,...h}){C();const x=r.colors,j=S({colors:x,xaxis:{categories:r.categories},yaxis:{labels:{formatter:s=>s.toFixed(2)}},legend:{show:!0},tooltip:{x:{format:"dd/MM/yy HH:mm"},y:{formatter:s=>`${s.toFixed(2)} ${l}`}},...r.options}),t=S({colors:x,xaxis:{categories:r.categories},yaxis:{labels:{formatter:s=>(s==null?void 0:s.toLocaleString())||""}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,formatter:s=>s?`${s==null?void 0:s.toLocaleString()}`:"",offsetY:-20,style:{fontSize:"11px",colors:["#808080"]}},legend:{show:!0},tooltip:{x:{format:"dd/MM/yy HH:mm"},y:{formatter:s=>`${s.toFixed(2)} ${l}`}},...r.options}),f=S({colors:x,xaxis:{categories:r.categories},yaxis:{labels:{formatter:s=>s.toFixed(2)}},legend:{show:!0},tooltip:{x:{format:"dd/MM/yy HH:mm"},y:{formatter:s=>`${s.toFixed(2)} ${l}`}},chart:{animations:{enabled:!1,speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},...r.options});return e.jsxs(E,{...h,children:[e.jsx(O,{title:p,subheader:m}),e.jsx(B,{type:i,series:r.series,options:i==="line"?j:i==="bar"?t:i==="area"?f:{},...h,height:c})]})}function W({sx:p,post:m,unit:c,type:i,...l}){const r=c||(i==="electricity"?"kWh":"m¬≥"),h=c||(i==="electricity"?"#FAF0E7":"#cee9fe"),x=c||(i==="electricity"?"#FF7400":"#0085ed");return e.jsx(E,{sx:p,...l,children:e.jsx(E,{sx:{height:"100%",px:1.5,bgcolor:h},children:e.jsxs(V,{children:[e.jsxs(k,{variant:"subtitle1",color:"textSecondary",children:[i==="electricity"?"‚ö°":"üíß"," ",m.title]}),e.jsxs(k,{variant:"caption",component:"div",color:"text.disabled",pb:1,pl:3,children:["‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ",m.timestamp||"--/--/----, --:--:--"]}),e.jsxs(b,{gap:.1,display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(k,{variant:"h3",pl:3,color:x,children:[m.value||"------"," ",c||r]}),e.jsx(F,{title:"‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",children:e.jsx(I,{children:e.jsx(N,{src:"/assets/icons/iconify/info.svg",style:{width:"30px",height:"30px"}})})})]})]})})})}const y={wh:.001,kwh:1,mwh:1e3,gwh:1e6,twh:1e9};function $(p,m,c){const i=m.toLowerCase(),l=c.toLowerCase();if(!(i in y)||!(l in y))throw new Error("Invalid unit. Supported units are: Wh, kWh, MWh, GWh, TWh");return p*y[i]/y[l]}function z(){const p=L();T(),v();const[m,c]=g.useState(!0),[i,l]=g.useState(0),[r,h]=g.useState(),[x,j]=g.useState(),[t,f]=g.useState();g.useEffect(()=>{(async()=>{try{const n=["‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏û‡∏∏‡∏ò","‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ","‡∏®‡∏∏‡∏Å‡∏£‡πå","‡πÄ‡∏™‡∏≤‡∏£‡πå","‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå"];if(i===0){const o=await R(),w=o.meterData.map(u=>({name:u.meter_position,data:u.weeklyData.currentWeek.map(D=>$(D.difference,u.meter_unit,"kwh"))}));h(o),f({title:"‚ö° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",subheader:`‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${o.weekStart} ‡∏ñ‡∏∂‡∏á ${o.weekEnd}`,categories:n,series:w})}else if(i===1){const o=await K(),w=o.meterData.map(u=>({name:u.meter_position,data:u.weeklyData.currentWeek.map(D=>D.difference)}));j(o),f({title:"üíß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤",subheader:`‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${o.weekStart} ‡∏ñ‡∏∂‡∏á ${o.weekEnd}`,categories:n,series:w})}c(!1)}catch(n){n.status===401||n.status===403?p("/login"):(A.fire({icon:"error",title:"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î...",text:"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ!",showConfirmButton:!1}),console.error("Error fetching data:",n))}})()},[m,p,i]);const s=(a,n)=>{l(n)};return e.jsxs(b,{sx:{p:3,pt:1},children:[e.jsxs(q,{value:i,onChange:s,sx:{mb:3},children:[e.jsx(H,{label:"‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‚ö°"}),e.jsx(H,{label:"‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤ üíß"})]}),i===0&&e.jsxs(b,{children:[e.jsx(d,{container:!0,spacing:3,sx:{mb:4,minHeight:300},children:e.jsx(d,{item:!0,xs:12,children:e.jsx(_,{type:"bar",title:t==null?void 0:t.title,subheader:t==null?void 0:t.subheader,unit:"kWh",chart:{categories:(t==null?void 0:t.categories)||[],series:(t==null?void 0:t.series)||[]},sx:{px:.5,py:1},height:325})})}),e.jsx(d,{container:!0,spacing:3,sx:{mb:4,minHeight:135},children:r==null?void 0:r.meterData.map((a,n)=>{var o;return e.jsx(d,{item:!0,xs:12,md:6,xl:4,children:e.jsx(W,{post:{title:a.meter_position,timestamp:a.weeklyData.latestData.timestamp,value:(o=$(a.weeklyData.latestData.value,a.meter_unit,"kwh"))==null?void 0:o.toLocaleString()},type:"electricity"})},a.energy_meter_id+n)})})]}),i===1&&e.jsxs(b,{children:[e.jsx(d,{container:!0,spacing:3,sx:{mb:4,minHeight:300},children:e.jsx(d,{item:!0,xs:12,children:e.jsx(_,{type:"bar",title:"üíß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤",subheader:"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ",unit:"m¬≥",chart:{categories:(t==null?void 0:t.categories)||[],series:(t==null?void 0:t.series)||[]},sx:{px:.5,py:1},height:325})})}),e.jsx(d,{container:!0,spacing:3,sx:{mb:4,minHeight:135},children:x==null?void 0:x.meterData.map((a,n)=>{var o;return e.jsx(d,{item:!0,xs:12,md:6,xl:4,children:e.jsx(W,{post:{title:a.meter_position,timestamp:a.weeklyData.latestData.timestamp,value:(o=a.weeklyData.latestData.value)==null?void 0:o.toLocaleString()},type:"water"})},a.energy_meter_id+n)})})]})]})}function re(){return e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsxs("title",{children:[" ",`‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô - ${G.appName}`]})}),e.jsx(z,{})]})}export{re as default};
